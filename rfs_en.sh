#!/usr/bin/env bash
curl -s https://en.wikipedia.org/wiki/Federal_subjects_of_Russia | sed -n '/wikitable sortable/,/\/table/p' | tr -d '\n' | sed -r 's/<\/?tr[^<>]*>/\n/g; s/<\/?t[dh][^<>]*>/;/g; s/<[^<>]+>|\[[0-9a-z]+\]|,//g;' | awk -F ';' 'BEGIN {OFS=",";print "#,Federal_Subject,Capital,Federal_Discrict,Economic_Region,Area(km^2),Population,Year_Established"} $2~/^[0-9]{2}$/ {print $2,$4,$6,$12,$14,$16,$18,$20; ar += $16; pop += $18} END {print ",,,,Totals",ar,pop}'
